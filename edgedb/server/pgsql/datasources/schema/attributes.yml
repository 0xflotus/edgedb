##
# Copyright (c) 2013 MagicStack Inc.
# All rights reserved.
#
# See LICENSE for details.
##


%SCHEMA edgedb.server.datasources.schemas.Sql
%NAME Attributes
---
params:
    name:
        type: str

filters:
    - format: dict

source: |
    SELECT
            a.id                    AS id,
            a.name                  AS name,
            a.title                 AS title,
            a.description           AS description,
            edgedb._resolve_type(a.type)
                                    AS type
        FROM
            edgedb.attribute a
        WHERE
            %(name)s::text IS NULL OR a.name LIKE %(name)s::text
...


%SCHEMA edgedb.server.datasources.schemas.Sql
%NAME AttributeValues
---
params:
    name:
        type: str

filters:
    - format: dict

source: |
    SELECT
            a.id                        AS id,
            a.name                      AS name,
            edgedb._resolve_type_name(a.subject)
                                        AS subject_name,
            edgedb._resolve_type_name(a.attribute)
                                        AS attribute_name,
            a.value                     AS value
        FROM
            edgedb.AttributeValue a
        WHERE
            %(name)s::text IS NULL OR a.name LIKE %(name)s::text
...
