##
# Copyright (c) 2008-2010 Sprymix Inc.
# All rights reserved.
#
# See LICENSE for details.
##


%SCHEMA semantix.lang.yaml.schema.Schema
%NAME Semantics
---
type: map
object: semantix.caos.backends.yaml.MetaSet
mapping:
    "backend":
        type: str
        required: no
        default: "data"
    "concepts":
        type: map
        default: {}
        mapping:
            =:
                type: map
                object: semantix.caos.backends.yaml.Concept
                mapping:
                    "title": &TEXT_WITH_GRAM_CATEGORIES
                        type: choice
                        object: semantix.caos.backends.yaml.WordCombination
                        choice:
                            - type: str
                            - type: map
                              mapping:
                                =:
                                    type: str

                    "description":
                        type: str

                    "extends":
                        type: choice
                        default:
                        choice:
                            - type: str
                            - type: seq
                              sequence:
                                - type: str

                    "links":
                        type: map
                        default: {}
                        mapping:
                            =:
                                type: map
                                object: semantix.caos.backends.yaml.LinkList
                                type: choice
                                required: yes
                                choice:
                                  - type: str
                                  - type: seq
                                    sequence:
                                        - type: str
                                  - type: map
                                    mapping:
                                        =:
                                            type: map
                                            mapping:
                                              "title":
                                                  *TEXT_WITH_GRAM_CATEGORIES
                                              "description":
                                                  type: str
                                              "required":
                                                  type: bool
                                                  default: False
                                              "mapping":
                                                  type: str
                                                  enum: ["1*", "11", "**", "*1"]
                                                  required: yes
                                                  default: "11"

                                              "mods": &ATOM_MODS
                                                  type: seq
                                                  sequence:
                                                      - type: choice
                                                        choice:
                                                            - type: map
                                                              object: semantix.caos.backends.yaml.AtomModMaxLength
                                                              mapping:
                                                                "max-length":
                                                                    type: int
                                                            - type: map
                                                              object: semantix.caos.backends.yaml.AtomModMinLength
                                                              mapping:
                                                                "min-length":
                                                                    type: int
                                                            - type: map
                                                              object: semantix.caos.backends.yaml.AtomModRegExp
                                                              mapping:
                                                                "regexp":
                                                                    type: str
                                                            - type: map
                                                              object: semantix.caos.backends.yaml.AtomModExpr
                                                              mapping:
                                                                "expr":
                                                                    type: str
                                              "comparison":
                                                  type: str
                                                  enum: [cidirect, fuzzy]
                                              "default":
                                                  type: str
                                              "properties":
                                                  type: map
                                                  mapping:
                                                    =:
                                                        type: any


                    "heuristics":
                        type: map
                        mapping:
                            "comparison":
                                type: seq
                                sequence:
                                    -
                                        type: map
                                        mapping:
                                            "link":
                                                type: str

                                            "attribute":
                                                type: str

                                            "weight":
                                                type: float
                                                range: {min: 0.0, max: 1.0}
                                                required: yes

    "atoms":
        type: map
        default: {}
        mapping:
            =: # name of an atom
                type: map
                object: semantix.caos.backends.yaml.Atom
                required: yes
                mapping:
                    "title":
                        *TEXT_WITH_GRAM_CATEGORIES

                    "description":
                        type: str

                    "extends":
                        type: choice
                        default:
                        choice:
                            - type: str
                            - type: seq
                              sequence:
                                - type: str

                    "default":
                        type: any
                        default:

                    "mods": *ATOM_MODS

    "links":
        type: map
        default: {}
        mapping:
            =: # name of a link
                type: map
                object: semantix.caos.backends.yaml.LinkDef
                required: yes
                mapping:
                    "title":
                        *TEXT_WITH_GRAM_CATEGORIES

                    "description":
                        type: str

                    "extends":
                        type: choice
                        default:
                        choice:
                            - type: str
                            - type: seq
                              sequence:
                                - type: str

                    "mapping":
                        type: str
                        enum: ["1*", "11", "**", "*1"]
                        required: yes
                        default: "11"

                    "properties":
                        type: map
                        default: {}
                        mapping:
                            =:
                                type: choice
                                object: semantix.caos.backends.yaml.LinkProperty
                                choice:
                                    - type: str
                                    - type: map
                                      mapping:
                                        =:
                                            type: map
                                            max-length: 1
                                            min-length: 1
                                            mapping:
                                                "title":
                                                    *TEXT_WITH_GRAM_CATEGORIES
                                                "description":
                                                    type: str
                                                "required":
                                                    type: bool
                                                    default: False
                                                "mods": *ATOM_MODS
